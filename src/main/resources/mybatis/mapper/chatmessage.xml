<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.dao.mybatis.ChatMessageDao">
  <insert id="insert"
    parameterType="ChatMessage">
    <selectKey keyProperty="messageId" resultType="Integer" order="BEFORE">
      select seq_chat_message_message_id.nextval from dual
    </selectKey>
  insert into ttm.chat_message(
    message_id, chatroom_id, sender_id, message, is_read, read_at, created_at)
  values(
    #{messageId}, #{chatroomId}, #{senderId}, #{messageContent}, #{isRead}, sysdate, sysdate
  )
  </insert>

  <select id="selectByChatId"
    parameterType="Integer"
    resultType="ChatMessage">
  select (
    message_id, chatroom_id, sender_id, message, is_read, read_at, created_at
  )
  from ttm.chat_message
  where message_id = #{value}
  </select>


</mapper>
