<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.dao.CommentDao">
  
	<insert id="insert"
		parameterType="Comment">
		<selectKey keyProperty="commentId" resultType="Integer" order="BEFORE"> 
      select seq_comments_comment_id.nextval from dual 
    </selectKey> 
    insert into comments ( comment_id, comment_content, user_id, post_id, created_at ) 
    values ( #{commentId}, #{commentContent}, #{cwriter}, #{cpostId}, SYSTIMESTAMP ) 
  </insert>

  <select id="selectAllCommentByPostId"
    parameterType="Integer"
    resultType="Comment">
    select 
      comment_id, 
      comment_content, 
      user_id as cwriter, 
      post_id as cpostId, 
      created_at
      from comments 
      where post_id = #{cpostId}
    </select>
    
    <select id="selectCommentByCommentId"
    parameterType="Integer"
    resultType="Comment">
    select 
      comment_id, 
      comment_content, 
      user_id as cwriter, 
      post_id as cpostId, 
      created_at
    from comments 
    where comment_id = #{commentId}
  </select>

	<update id="update"
		parameterType="Comment"> 
    update comments 
    set comment_content = #{commentContent} 
    where comment_id = #{commentId} 
  </update>

	<delete id="delete"
		parameterType="Integer"> 
    delete from comments 
    where comment_id=#{value} 
  </delete>

</mapper>
